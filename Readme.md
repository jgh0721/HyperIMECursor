# IME 상태 표시기

다양한 방법을 사용하여 마우스 커서 옆에 IME 상태를 표시합니다. 

# IME 상태 획득

## IMM( Input Method Manager )

1. AttachThreadInput
   * 지정한 스레드와 입력 상태를 동기화하는 함수를 이용하여 IME 상태 획득
     * 별도의 메시지 큐를 거치지 않아 동작이 매우 빠르지만, 대상 프로세스가 응답없음 상태라면 함께 응답없음 상태가 될 수 있음  
2. SendMessage

# 후킹 

※ SetWindowsHookEx 를 이용하여 프로세스 전역 후킹 사용

## 키보드

1. 한영키가 눌림 상태를 파악하여 즉시 IME 상태를 자체적으로 변경 처리함. 
2. Ctrl + Up/Down 키가 눌렸을 때, 스크롤로 판단하여 일시적으로 캐럿 표시기 숨김.
 
## 마우스 

1. 마우스 스크롤 휠 이벤트를 전달받아 스크롤 하는 동안 표시기가 보이지 않도록 함.

# 문제 해결

* 관리자 프로세스의 IME 상태가 반영되지 않음
    - 해당 실행파일을 관리자 권한으로 실행합니다. 

# 변경 이력

2025-12-09

* 자동 실행 관련 설정이 작동하도록 수정

2025-12-03

* 캐럿 위치에 따른 한영상태 표시
* 팝업 인디케이터 표시 추가

2025-10-29

* 초기 버전

# 알려진 문제점

# 참조한 프로젝트

https://github.com/fanlumaster/FullIME
